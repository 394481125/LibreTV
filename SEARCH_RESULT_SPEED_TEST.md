# 搜索结果页面一键测速功能

## 功能概述

搜索结果页面也已新增**一键测速功能**，让用户在浏览搜索结果时能够快速了解各个资源源的速度情况。

## 功能位置

- 📍 每个搜索结果卡片底部左侧：悬浮的 **"🚀 测速"** 按钮
- 📍 卡片顶部右角：实时显示的速度徽章
- 📍 卡片底部：实时显示的速度文本

## 使用方式

### 1. 执行搜索
搜索任意内容，获得搜索结果列表

### 2. 在卡片上测速
- 将鼠标悬停在任意搜索结果卡片上
- 卡片底部左侧会显示 **"🚀 测速"** 按钮
- 点击按钮开始测速（约 1-5 秒）

### 3. 查看测速结果
测速完成后，您将看到：
- **顶部徽章**：实时显示速度值（ms）和等级图标
- **底部文本**：显示速度等级和响应时间
- **卡片边界**：左边界颜色反映速度等级
  - 🟢 绿色：快速（< 1500ms）
  - 🟡 黄色：中等（1500-3000ms）
  - 🔴 红色：慢速（> 3000ms）

## 速度指示说明

| 等级 | 响应时间 | 颜色 | 推荐度 |
|------|----------|------|--------|
| 快速 | < 1500ms | 🟢 绿 | ⭐⭐⭐ |
| 中等 | 1500-3000ms | 🟡 黄 | ⭐⭐ |
| 慢速 | > 3000ms | 🔴 红 | ⭐ |
| 失败 | 无响应/超时 | ❌ 灰 | ❌ |

## 工作原理

测速函数通过以下步骤进行：
1. 获取搜索结果的资源ID和数据源信息
2. 请求该资源的详情数据（带有 5 秒超时保护）
3. 计算整个请求的响应时间
4. 根据响应时间判断速度等级
5. 在卡片上实时显示结果

## 技术特性

- ✅ 无阻塞测试：测速不影响结果浏览
- ✅ 实时反馈：测试过程中有明确的加载状态
- ✅ 多源支持：支持内置 API 和自定义 API
- ✅ 错误处理：网络错误自动降级处理
- ✅ 超时保护：5 秒超时防止无限等待
- ✅ UI 增强：动画效果和颜色编码易于识别

## CSS 类和样式

| 类名 | 用途 |
|------|------|
| `.search-result-card` | 搜索结果卡片容器 |
| `.search-result-speed-btn` | 测速按钮 |
| `.search-result-speed-badge` | 速度徽章（顶部） |
| `.search-result-speed-text` | 速度文本（底部） |
| `.speed-indicator.good/medium/poor` | 速度等级样式 |

## 使用示例

### 场景1：选择最快的资源
1. 搜索"想看的视频"
2. 在搜索结果中逐个测速
3. 选择显示绿色边界和最低响应时间的卡片

### 场景2：批量测速对比
1. 同一个视频在多个数据源都有
2. 分别对各个源进行测速
3. 根据结果选择最优资源点击播放

## 常见问题

### Q: 为什么某个资源显示"❌ 失败"？
A: 可能原因包括：
- 网络连接问题
- 数据源服务器暂时无法访问
- CORS 跨域限制
- 5 秒超时（数据源响应过慢）

### Q: 测速结果是否准确？
A: 测速反映的是**当前时刻**该数据源的响应速度，会受以下因素影响：
- 实时网络状态
- 服务器负载
- 地理位置和 ISP
- 时间段差异

### Q: 为什么同一资源每次测速结果不同？
A: 这是正常的，因为：
- 网络状态时刻变化
- 服务器负载波动
- 测速包含 API 和网络往返时间

## 交互细节

- 🎯 **悬停显示**：只在鼠标悬停时显示测速按钮
- 🔄 **状态反馈**：测速中显示加载动画，按钮变灰
- 🎨 **视觉反馈**：卡片边界和底部文本实时变色
- 📢 **Toast 提示**：测速完成后显示结果提示

## 性能指标

- 单个资源测速：1-5 秒
- 测速不占用主线程：使用异步操作
- 内存占用：每个测速 < 1MB
- 网络流量：每次测速 < 100KB

---

**提示**：搜索结果页面的测速功能与播放器页面的测速功能相辅相成，帮助用户在选择资源源时做出最优决策。
